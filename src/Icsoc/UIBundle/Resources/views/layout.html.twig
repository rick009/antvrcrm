{% extends '@IcsocUI/base.html.twig' %}

{% block body %}
    <div data-options="region:'north',title:'North Title',split:true" style="height:100px;">
        {% block navbar %}{% endblock %}
    </div>
    <div data-options="region:'west',title:'<i class=\'fa fa-desktop\'></i> {{ 'Menus'|trans }}',split:true" style="width:200px;">
        {{ include('IcsocUIBundle::siderbar.html.twig') }}
    </div>
    <div data-options="region:'center'" style="padding:5px;">
        <div id="tt" class="easyui-tabs" fit="true" border="false">
            <div title='仪表盘'>
                <iframe name='mainFrame' frameborder='0' src='{{ path('icsoc_ui_dashboard') }}' scrolling='auto' style='width:100%;height:99%;'></iframe>
            </div>
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script type="application/javascript">
        $(document).ready(function () {
            var $menu_items = $('#siderbar').find('.pure-menu-item');
            $menu_items.on('click', function () {
                $menu_items.removeClass('pure-menu-selected');
                $(this).addClass('pure-menu-selected');
                var title = $(this).text();
                var url = $(this).attr('data-url');
                var icon = $(this).attr('data-icon');
                addTab(title, url, icon);
            });
        });

        function addTab(title, url, icon) {
            var $tt = $('#tt');
            if ($tt.tabs('exists',title)){
                $tt.tabs('select', title);
                var tab = $tt.tabs('getSelected');
                $tt.tabs('update', {
                    tab: tab,
                    options: {
                        title: title,
                        content: "<iframe name='mainFrame' frameborder='0' src='"+url+"' scrolling='auto' style='width:100%;height:99%;'></iframe>"
                    }
                });
            } else {
                $tt.tabs('add', {
                    title:title,
                    closable:true,
                    content: "<iframe name='mainFrame' frameborder='0' src='"+url+"' scrolling='auto' style='width:100%;height:99%;'></iframe>",
                    icon: icon,
                    cache: false
                });
            }
        }
    </script>
{% endblock %}